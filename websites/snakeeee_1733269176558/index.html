<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            background: #000;
            color: #fff;
        }
        canvas {
            display: block;
            margin: 20px auto;
            border: 1px solid #fff;
        }
        h1 {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Snake Game</h1>
    <p>Use arrow keys to move the snake. Eat the food and avoid crashing!</p>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        const box = 20; // Snake size
        let snake = [{ x: 9 * box, y: 9 * box }];
        let food = { x: Math.floor(Math.random() * 20) * box, y: Math.floor(Math.random() * 20) * box };
        let direction = "RIGHT";
        let score = 0;

        // Draw snake and food
        function draw() {
            ctx.fillStyle = "#000";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw snake
            for (let i = 0; i < snake.length; i++) {
                ctx.fillStyle = i === 0 ? "lime" : "green";
                ctx.fillRect(snake[i].x, snake[i].y, box, box);
            }

            // Draw food
            ctx.fillStyle = "red";
            ctx.fillRect(food.x, food.y, box, box);

            // Score
            ctx.fillStyle = "#fff";
            ctx.font = "20px Arial";
            ctx.fillText("Score: " + score, 10, 20);
        }

        // Move snake
        function moveSnake() {
            const head = { ...snake[0] };

            if (direction === "RIGHT") head.x += box;
            if (direction === "LEFT") head.x -= box;
            if (direction === "UP") head.y -= box;
            if (direction === "DOWN") head.y += box;

            // Check collision with walls or self
            if (
                head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height ||
                snake.some(segment => segment.x === head.x && segment.y === head.y)
            ) {
                clearInterval(game);
                alert("Game Over! Your score: " + score);
                document.location.reload();
            }

            // Check collision with food
            if (head.x === food.x && head.y === food.y) {
                score++;
                food = { x: Math.floor(Math.random() * 20) * box, y: Math.floor(Math.random() * 20) * box };
            } else {
                snake.pop();
            }

            snake.unshift(head);
        }

        // Change direction
        document.addEventListener("keydown", event => {
            if (event.key === "ArrowRight" && direction !== "LEFT") direction = "RIGHT";
            if (event.key === "ArrowLeft" && direction !== "RIGHT") direction = "LEFT";
            if (event.key === "ArrowUp" && direction !== "DOWN") direction = "UP";
            if (event.key === "ArrowDown" && direction !== "UP") direction = "DOWN";
        });

        // Game loop
        function gameLoop() {
            moveSnake();
            draw();
        }

        const game = setInterval(gameLoop, 100);
    </script>
</body>
</html>
